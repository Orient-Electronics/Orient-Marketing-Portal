<div class="well">
  <%= form_for :search, :html => { :method => 'get', :id => 'search_product' } do |form| %>
    <%= form.label :representative_id, 'Report of' %>
    <%= form.select :representative_id, Representative.all.collect { |b| [b.name, b.id] }, :include_blank => "All" %>
    <div class="form-actions">
      <%= form.submit "Go", :class => "btn btn-success" %>
    </div>
  <% end -%>
</div>

<h2>Sales Report</h2>
<% @reports.select {|f| f["report_type"] == "sales" }.each do |report| %>
  <div class="well">
    <div class="control-group">
      <label class="control-label">Representative</th>
      <div class="controls">
        <%= report.representative.try(:name) %>
      </div>
    </div>
    <div class="control-group">
      <label class="control-label">Report Start</th>
      <div class="controls">
        <%= report.start_at %>
      </div>
    </div>
    <div class="control-group">
      <label class="control-label">Report End</th>
      <div class="controls">
        <%= report.end_at %>
      </div>
    </div>
  </div>
  <% Product.all.each do |product| %>
    <blockquote>
      <p><%= product.name %></p>
      <small><%= product.info %></small>
    </blockquote>
    <table class="table table-striped table-bordered">
      <tr>
        <% product.brands.each do |brand| %>
          <th><%= brand.name %></th>
        <% end -%>
      </tr>
      <tr>
        <% product.brands.each do |brand| %>
          <% report.report_lines.where(:product_id=>product.id,:brand_id=>brand.id).each do |line| %>
            <td><%= line.data %></td>
          <% end -%>
        <% end -%>
      </tr>
    </table>
  <% end -%>
<% end -%>

<hr>

<h2>Display Corner Report</h2>
<% @reports.select {|f| f["report_type"] == "display_corner" }.each do |report| %>
  <div class="well">
    <div class="control-group">
      <label class="control-label">Representative</th>
      <div class="controls">
        <%= report.representative.try(:name) %>
      </div>
    </div>
  </div>
  <% Product.all.each do |product| %>
    <blockquote>
      <p><%= product.name %></p>
      <small><%= product.info %></small>
    </blockquote>
    <table class="table table-striped table-bordered">
      <tr>
        <% product.brands.each do |brand| %>
          <th><%= brand.name %></th>
        <% end -%>
      </tr>
        <tr>
          <% product.brands.each do |brand| %>
            <% report.report_lines.where(:product_id=>product.id,:brand_id=>brand.id).each do |line| %>
              <td><%= line.data.to_i==1 ? "Yes" : "No" %></td>
            <% end -%>
          <% end -%>
        </tr>
    </table>
  <% end -%>
<% end -%>


<hr>

<h2>Display Report</h2>
<% @reports.select {|f| f["report_type"] == "display" }.each do |report| %>
  <div class="well">
    <div class="control-group">
      <label class="control-label">Representative</th>
      <div class="controls">
        <%= report.representative.try(:name) %>
      </div>
    </div>
  </div>
  <% Product.all.each do |product| %>
    <blockquote>
      <p><%= product.name %></p>
      <small><%= product.info %></small>
    </blockquote>
    <table class="table table-striped table-bordered">
      <tr>
        <% product.brands.each do |brand| %>
          <th><%= brand.name %></th>
        <% end -%>
      </tr>
        <tr>
          <% product.brands.each do |brand| %>
            <% report.report_lines.where(:product_id=>product.id,:brand_id=>brand.id).each do |line| %>
              <td><%= line.data.to_i %></td>
            <% end -%>
          <% end -%>
        </tr>
    </table>
  <% end -%>
<% end -%>