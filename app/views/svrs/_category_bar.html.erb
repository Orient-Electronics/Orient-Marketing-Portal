<textarea class="hide dispaly_category_data">
  <% categories.each do |category| %>
    <%= [category.name,Report.category_display(reports,category.id,brand)].join("|") %>
    <%= "~" unless category == categories.last %>
  <% end -%>
</textarea>
<textarea class="hide sale_category_data">
  <% categories.each do |category| %>
    <%= [category.name,Report.category_sales(reports,category.id,brand)].join("|") %>
    <%= "~" unless category == categories.last %>
  <% end -%>
</textarea>
<div id='category_data_chart' class="jFax-chart"></div>
<table class="table table-striped table-condensed chart-data-table">
  <thead>
    <tr>
      <th>Category Name</th>
      <th>Dispaly Data</th>
      <th>Sales Data</th>
    </tr>
  </thead>
  <tbody>
    <% cat_display_sum = cat_sale_sum = counter = 0   %>
    <% categories.uniq.each_with_index do |category, index| %>
      <tr>
        <td><%= category.name %></td>
        <td><%= Report.category_display(reports,category.id,brand) %></td>
        <% cat_display_sum += Report.category_display(reports, category.id, brand ) %>
        <td><%= Report.category_sales(reports,category.id,brand) %></td>
        <% cat_sale_sum += Report.category_sales(reports, category.id, brand) %>
        <% counter = index + 1%>
      </tr>
    <% end %> 
    <tr>
      <td class="form-portion-head"> Net Result</td>
      <td class="form-portion-head"> <%= cat_display_sum/counter %></td>
      <td class="form-portion-head"> <%= cat_sale_sum %></td>
    </tr> 
  </tbody>
</table>

<script type="text/javascript">
  $('document').ready(function(){
    loadCategoryChart();  
  });
</script>
