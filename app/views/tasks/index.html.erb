<%- model_class = Task -%>
<div class="page-header">
  <h1><%= "#{@parent.name} - " if @parent.present? %><%=t '.title', :default => model_class.model_name.human.pluralize.titleize %></h1>
</div>
<div class="row-fluid">
  <div class="span12">
    <div class="box-title">
      <h3>
        Assigned Task
      </h3>
    </div>
    <div class="box-content nopadding">
      <table class="table table-hover table-nomargin" id="assign-by-data">
        <thead>
          <tr class='thefilter row-fluid'>
              <th class="span2"><input type="text" name="Assigned by" placeholder="Assigned by" class="search_init span12" /></th>
              <th class="span2"><input type="text" name="Comment" placeholder="Comment" class="search_init span12" /></th>
              <th class="span2"><input type="text" name="Shop" placeholder= "Shop"  class="search_init span12" /></th>
              <th class="span2"><input type="text" name="Status" placeholder="Status" class="search_init span12" /></th>

           </tr>
          <tr class="row-fluid"> 
            <th class="span2">Assigned by</th>
            <th class="span2">Comment</th>
            <th class="span2">Shop</th>
            <th class="span2">Status</th>
          </tr>
        </thead>
        
        <tbody>    
          <% @task.each do |t| %>
            <tr class="row-fluid">
              <td class"span2"><%= User.find(t.assigned_by).name %></td>
              <td class"span2"><%= t.comment %></td>
              <% if t.shop_id.blank? %>
                <td class"span2"><%= nil %></td>
              <%else%>
                <td class"span2"><%= link_to Shop.find(t.shop_id).dealer_name, shop_path(t.shop_id) %></td> 
              <%end%>
              <% if t.status == 'pending'%>
                <td class"span2"><%= link_to 'done' , change_task_path(t)%></td> 
              <%else%>
                <td class"span2"><%= t.status %></td>
              <%end%>
            </tr>
          <%end%>
        </tbody>
      </table> 
    </div>
  </div>
</div>  
<div class="row-fluid">
  <div class="span12">
    <div class="box-title">
      <h3>
        Created Tasks
      </h3>
    </div>
    <div class="box-content nopadding">
      <table class="table table-hover table-nomargin" id="assign-to-data">
        <thead>
          <tr class='thefilter row-fluid'>
              <th class="span2"><input type="text" name="Assigned To" placeholder="Assigned To" class="search_init span12" /></th>
              <th class="span2"><input type="text" name="Comment" placeholder="Comment" class="search_init span12" /></th>
              <th class="span2"><input type="text" name="Shop" placeholder= "Shop"  class="search_init span12" /></th>
              <th class="span2"><input type="text" name="Status" placeholder="Status" class="search_init span12" /></th>

           </tr>
          <tr class="row-fluid"> 
            <th class="span2">Assigned To</th>
            <th class="span2">Comment</th>
            <th class="span2">Shop</th>
            <th class="span2">Status</th>
          </tr>
        </thead>
        
        <tbody>    
          <% @task.each do |t| %>
            <tr class="row-fluid">
              <td class"span2"><%= User.find(t.assigned_to).name %></td>
              <td class"span2"><%= t.comment %></td>
              <% if t.shop_id.blank? %>
                <td class"span2"><%= nil %></td>
              <%else%>
                <td class"span2"><%= link_to Shop.find(t.shop_id).dealer_name, shop_path(t.shop_id) %></td> 
              <%end%>
              <% if t.status == 'pending'%>
                <td class"span2"><%= link_to 'done' , change_task_path(t)%></td> 
              <%else%>
                <td class"span2"><%= t.status %></td>
              <%end%>
            </tr>
          <%end%>
        </tbody>
      </table> 
    </div>
  </div>
</div>  
<script type="text/javascript" charset="utf-8">
  var asInitVals = new Array();
  
  $(document).ready(function() {
    var oTable = $('#assign-by-data').dataTable( {
      "oLanguage": {
        "sSearch": "Search all columns:"
      }
    } );  
    $(".thefilter input").keyup( function () {
      /* Filter on the column (the index) of this element */
      oTable.fnFilter( this.value, $(".thefilter input").index(this) );
    } );
    
    
    
    /*
     * Support functions to provide a little bit of 'user friendlyness' to the textboxes in 
     * the footer
     */
    $(".thefilter input").each( function (i) {
      asInitVals[i] = this.value;
    } );
    
    $(".thefilter input").focus( function () {
      if ( this.className == "search_init" )
      {
        this.className = "";
        this.value = "";
      }
    } );
    
    $(".thefilter input").blur( function (i) {
      if ( this.value == "" )
      {
        this.className = "search_init";
        this.value = asInitVals[$(".thefilter input").index(this)];
      }
    } );
  } );

   
</script>

<script type="text/javascript" charset="utf-8">
  var asInitVals = new Array();
  
  $(document).ready(function() {
    var oTable = $('#assign-to-data').dataTable( {
      "oLanguage": {
        "sSearch": "Search all columns:"
      }
    } );  
    $(".thefilter input").keyup( function () {
      /* Filter on the column (the index) of this element */
      oTable.fnFilter( this.value, $(".thefilter input").index(this) );
    } );
    
    
    
    /*
     * Support functions to provide a little bit of 'user friendlyness' to the textboxes in 
     * the footer
     */
    $(".thefilter input").each( function (i) {
      asInitVals[i] = this.value;
    } );
    
    $(".thefilter input").focus( function () {
      if ( this.className == "search_init" )
      {
        this.className = "";
        this.value = "";
      }
    } );
    
    $(".thefilter input").blur( function (i) {
      if ( this.value == "" )
      {
        this.className = "search_init";
        this.value = asInitVals[$(".thefilter input").index(this)];
      }
    } );
  } );

   
</script>